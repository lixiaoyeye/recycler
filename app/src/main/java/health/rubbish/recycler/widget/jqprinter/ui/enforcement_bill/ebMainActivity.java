package health.rubbish.recycler.widget.jqprinter.ui.enforcement_bill;

import java.text.SimpleDateFormat;

import health.rubbish.recycler.R;
import health.rubbish.recycler.base.App;
import health.rubbish.recycler.widget.jqprinter.printer.esc.ESC;
import health.rubbish.recycler.widget.jqprinter.printer.esc.ESC.BAR_UNIT;
import health.rubbish.recycler.widget.jqprinter.printer.JQPrinter;
import health.rubbish.recycler.widget.jqprinter.printer.Printer_define.ALIGN;
import health.rubbish.recycler.widget.jqprinter.printer.Printer_define.PRINTER_MODEL;

import android.os.Bundle;
import android.app.Activity;
import android.content.Intent;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.util.Log;
import android.view.Menu;
import android.view.View;
import android.widget.Button;
import android.widget.Toast;

public class ebMainActivity extends Activity {
    private JQPrinter printer = null;
    private Button buttonPrint = null;

	@Override
	protected void onCreate(Bundle savedInstanceState) {
		super.onCreate(savedInstanceState);
		setContentView(R.layout.activity_enforcement_bill);
		
		buttonPrint = (Button)findViewById(R.id.ButtonEnforementBillPrint);
		
		App app = (App)getApplication();
		if (app.printer != null)
		{
			printer = app.printer;
		}
		else
		{
			Log.e("JQ", "app.printer null");
		}
	}

	@Override
	public boolean onCreateOptionsMenu(Menu menu) {
		// Inflate the menu; this adds items to the action bar if it is present.
		getMenuInflater().inflate(R.menu.enforcement_bill, menu);
		return true;
	}
	
	//byte 1���ֽڷ�Χ��-1~127
	//char 2���ֽڷ�Χ��0~65535
	private char[] logo_data = {0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x01, 0x01,
			0x01, 0x03, 0x03, 0x03, 0x03, 0x03, 0x07, 0x07, 0x07, 0x07, 0x07,
			0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x03, 0x03, 0x03, 0x03,
			0x03, 0x01, 0x01, 0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x01, 0x03, 0x03, 0x07, 0x0F, 0x0F, 0x1F, 0x1E, 0x3F, 0x3D, 0x7C,
			0x7F, 0xFF, 0xF0, 0xF8, 0xFC, 0xFE, 0xEE, 0xE0, 0xFC, 0xFD, 0xFD,
			0xFF, 0xFF, 0xFF, 0xBF, 0x81, 0xEF, 0xAF, 0x81, 0xFF, 0xE1, 0x81,
			0xC5, 0xC9, 0xFD, 0xF9, 0xF3, 0xE0, 0xF8, 0xFE, 0xFC, 0xE1, 0xF7,
			0xFF, 0xFF, 0xFB, 0xFC, 0x7C, 0x7E, 0x3F, 0x3E, 0x1F, 0x1F, 0x0F,
			0x0F, 0x07, 0x03, 0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01,
			0x07, 0x0F, 0x1F, 0x3F, 0x7F, 0x7E, 0xFA, 0xF9, 0xFC, 0xE2, 0xD9,
			0x9D, 0xDD, 0x43, 0x3F, 0x0F, 0x2F, 0x3F, 0x3F, 0xBF, 0x3E, 0xFE,
			0xFC, 0x7C, 0xF8, 0xF8, 0xF8, 0xF0, 0xF0, 0xF0, 0xF0, 0xE0, 0xE0,
			0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xF0, 0xF0,
			0xF0, 0xF0, 0xF0, 0xF8, 0x78, 0x78, 0x7C, 0x7C, 0xFE, 0x1E, 0x7F,
			0xEF, 0xC7, 0x9F, 0x1B, 0xC3, 0x8F, 0xBF, 0xFF, 0xFF, 0xFE, 0xFC,
			0xF9, 0xFD, 0x7E, 0x3F, 0x1F, 0x0F, 0x07, 0x03, 0x01, 0x00, 0x00,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x03, 0x0F, 0x3F, 0x7F, 0xFF, 0xFC, 0xFE, 0xF7, 0xF3, 0xB0,
			0x32, 0x33, 0x93, 0xCF, 0xDF, 0x7F, 0x7E, 0xFC, 0xF8, 0xF1, 0xE0,
			0xC0, 0xC0, 0x80, 0x00, 0x01, 0x03, 0x03, 0x07, 0x07, 0x07, 0x07,
			0x0C, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04,
			0x07, 0x07, 0x07, 0x03, 0x03, 0x01, 0x00, 0x00, 0x80, 0xC0, 0xE0,
			0xF0, 0xF0, 0xF8, 0xFC, 0x7F, 0x3F, 0x9F, 0xBF, 0x07, 0x04, 0xCE,
			0xD0, 0xF7, 0xF1, 0xFE, 0xFF, 0xFF, 0x7F, 0x1F, 0x07, 0x03, 0x00,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x00, 0x00, 0x00, 0x01, 0x0F, 0x7F, 0xFF, 0xFF, 0xFF, 0xFF,
			0xDF, 0x9F, 0x8F, 0xAF, 0x27, 0x3F, 0x3F, 0xFF, 0xFE, 0xF8, 0xF0,
			0xC7, 0x01, 0x00, 0x1C, 0x7F, 0xFF, 0x01, 0x01, 0x03, 0x33, 0xF7,
			0xF6, 0xF6, 0xE6, 0xE6, 0xCC, 0x89, 0x02, 0x04, 0x04, 0x08, 0x00,
			0x10, 0x10, 0x00, 0x00, 0x20, 0x21, 0x21, 0x21, 0x21, 0x20, 0x20,
			0x00, 0x10, 0x10, 0x00, 0x08, 0x04, 0x04, 0x02, 0x85, 0xC6, 0xE6,
			0xE6, 0xF7, 0xF7, 0x73, 0x3B, 0x01, 0x00, 0x01, 0xFF, 0x3F, 0x08,
			0x00, 0x83, 0xC3, 0xF0, 0xFC, 0xFF, 0x7F, 0x1F, 0xBB, 0x38, 0x5A,
			0x11, 0xF7, 0xF1, 0xFD, 0xFF, 0xFF, 0xFF, 0x1F, 0x07, 0x00, 0x00,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1F,
			0xFF, 0xFF, 0xFF, 0xFF, 0xFB, 0x9A, 0x9C, 0x8C, 0x85, 0xB7, 0x7F,
			0xFF, 0xFF, 0xF8, 0xC0, 0x07, 0x07, 0x01, 0xF8, 0xFE, 0x1F, 0x03,
			0xE6, 0xCC, 0x9C, 0x9C, 0x39, 0x38, 0x30, 0x62, 0x58, 0x20, 0x40,
			0x80, 0x00, 0x07, 0x07, 0x04, 0x04, 0x04, 0x07, 0x06, 0x03, 0x0F,
			0xFF, 0x30, 0x10, 0x10, 0xF8, 0xFF, 0x0F, 0x03, 0x06, 0x07, 0x04,
			0x04, 0x04, 0x06, 0x07, 0x00, 0x80, 0x40, 0x30, 0x6C, 0x33, 0x38,
			0x19, 0x9C, 0x9C, 0xCC, 0xE6, 0xE3, 0x01, 0x3F, 0xFE, 0xF8, 0x01,
			0x0F, 0x01, 0xC0, 0xFC, 0xFF, 0xFF, 0x4F, 0x92, 0x3E, 0x3E, 0x96,
			0xE0, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0x07, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x1F, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
			0x24, 0x2D, 0xAC, 0xA9, 0xA1, 0xFF, 0xFF, 0xFF, 0xE3, 0x00, 0x00,
			0x87, 0xF1, 0xF8, 0x7C, 0x1E, 0xC7, 0x8F, 0x38, 0x71, 0x63, 0xE7,
			0xCC, 0x00, 0xFF, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xFF, 0xFF,
			0x00, 0x00, 0x00, 0xFB, 0x01, 0xFE, 0xFC, 0xF8, 0x00, 0x01, 0x01,
			0x00, 0xF8, 0xFC, 0x02, 0x01, 0xFF, 0x00, 0x00, 0x00, 0x00, 0xFF,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x11, 0x80, 0xE7, 0x63, 0x71,
			0x38, 0x1E, 0xC7, 0x87, 0x3E, 0x7C, 0xF8, 0xE3, 0x0F, 0x00, 0x00,
			0xFF, 0xFF, 0xFF, 0x6C, 0xEB, 0xEB, 0xEB, 0x09, 0x6E, 0xFF, 0xFF,
			0xFF, 0xFF, 0xFF, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x00, 0xFE, 0xFF, 0xFF, 0xFF, 0xFF, 0xBF, 0xA1, 0x3C, 0xBC,
			0x1D, 0xE1, 0xFF, 0xFF, 0xFF, 0x07, 0x00, 0xC0, 0xF3, 0xF1, 0x79,
			0x38, 0x9C, 0x9E, 0x7E, 0xE0, 0x80, 0x0F, 0x7F, 0x1E, 0xC1, 0x10,
			0x02, 0x01, 0x00, 0x00, 0x00, 0xFE, 0xFE, 0x06, 0x06, 0x0A, 0x12,
			0x12, 0x26, 0x44, 0x08, 0x90, 0x30, 0x10, 0x90, 0x08, 0x04, 0x22,
			0x13, 0x03, 0x0B, 0x07, 0x03, 0x03, 0xFE, 0x00, 0x00, 0x00, 0x01,
			0x04, 0x31, 0x04, 0x7F, 0x1F, 0x80, 0xE0, 0x7F, 0x1E, 0xCE, 0x1C,
			0x3C, 0x78, 0xF1, 0xE0, 0x80, 0x01, 0x1F, 0xFF, 0xFF, 0xFD, 0x49,
			0x29, 0xA5, 0xA4, 0x2F, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xF0, 0x00,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xC0,
			0xF8, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFC, 0xFC, 0xF9, 0xF9,
			0xFC, 0xFF, 0xFE, 0x3F, 0x0F, 0x83, 0xC0, 0xE8, 0x66, 0x77, 0x73,
			0x33, 0x13, 0xF9, 0xF9, 0x05, 0xF0, 0xFC, 0x7F, 0x1F, 0x81, 0x00,
			0x20, 0x00, 0x08, 0x04, 0x04, 0x02, 0x02, 0x00, 0x01, 0x00, 0x00,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x02, 0x02, 0x04,
			0x00, 0x08, 0x10, 0x20, 0x41, 0x8F, 0x3F, 0xFC, 0xF8, 0x00, 0xFC,
			0xF9, 0x19, 0x19, 0x33, 0x73, 0x76, 0x74, 0xE0, 0xC1, 0x03, 0x0F,
			0x7E, 0xFC, 0xFC, 0xFE, 0xFE, 0xFE, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
			0xFF, 0xFF, 0xFE, 0xF8, 0xC0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xC0, 0xF0,
			0xF8, 0xFE, 0xFF, 0xE7, 0x4F, 0x0F, 0x8F, 0x03, 0x31, 0x03, 0x63,
			0xF7, 0xFF, 0xFF, 0x7F, 0x3F, 0x1F, 0x8E, 0x87, 0xC3, 0xD1, 0xD8,
			0xDC, 0xCC, 0xCE, 0xCE, 0xCE, 0xCE, 0x4E, 0x1E, 0x1E, 0x1E, 0x1E,
			0x1E, 0x1C, 0x1C, 0x19, 0x1A, 0x14, 0x14, 0x08, 0x08, 0x18, 0x18,
			0x38, 0x38, 0x39, 0x3D, 0x3C, 0x1E, 0x1E, 0x1E, 0x1F, 0x0F, 0x4F,
			0xCF, 0xCF, 0xCF, 0xCF, 0xCE, 0xCE, 0xCC, 0xC8, 0xD1, 0xC3, 0x87,
			0x0F, 0x1F, 0x3F, 0xFF, 0xEF, 0xC1, 0x81, 0x01, 0x01, 0x01, 0x00,
			0x00, 0x00, 0x03, 0x8F, 0xDF, 0xFC, 0xF8, 0xE0, 0x80, 0x00, 0x00,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xC0,
			0xE0, 0xF0, 0xF8, 0xFC, 0xFE, 0xFF, 0xFF, 0xFF, 0xF9, 0xF1, 0xC0,
			0x88, 0x04, 0x00, 0x00, 0x80, 0xC1, 0xC0, 0xE0, 0x71, 0x3F, 0x3F,
			0x1F, 0x1F, 0x0F, 0x0F, 0x07, 0x07, 0x07, 0x43, 0xC3, 0x83, 0x03,
			0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x83,
			0xC3, 0x63, 0x07, 0x07, 0x07, 0x0F, 0x0F, 0x0F, 0x1F, 0x1F, 0x3F,
			0x39, 0x70, 0xE2, 0xF9, 0xC8, 0xC0, 0xC6, 0xD4, 0x90, 0xF9, 0xFC,
			0xFE, 0xFE, 0xFF, 0xFF, 0xFF, 0xFE, 0xFC, 0xF8, 0xF0, 0xE0, 0x80,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x00, 0x80, 0xC0, 0xC0, 0xE0, 0xF0, 0x78, 0x38, 0x0C, 0x0C,
			0x1E, 0x3F, 0x7F, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFD, 0xFD, 0x7C,
			0x7C, 0x38, 0x00, 0x0E, 0x3A, 0x32, 0x82, 0x8E, 0xFF, 0xFF, 0xFF,
			0xFF, 0xFF, 0xFF, 0xFF, 0xF7, 0x87, 0x8B, 0xCB, 0x03, 0x00, 0xD0,
			0xD2, 0x92, 0xDE, 0xFE, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0x7F, 0x1F,
			0x02, 0x06, 0x0C, 0x9C, 0x18, 0x30, 0x70, 0x60, 0xC0, 0x80, 0x80,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x80, 0x80, 0x80, 0xC0, 0xC0, 0xC0, 0xE0, 0xE0, 0xE0, 0xE0, 0xF0,
			0xF0, 0x70, 0x70, 0x70, 0xF0, 0xF0, 0xF0, 0xF0, 0xF0, 0xF0, 0xF0,
			0xF0, 0x70, 0x70, 0x70, 0x70, 0x70, 0x60, 0x60, 0xE0, 0xE0, 0xC0,
			0xC0, 0xC0, 0x80, 0x80, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			0x00, 0x00,
			};
	
	public void print_image_test()
	{
		printer.esc.wakeUp();
		printer.esc.text.init();
		Bitmap bitmap = BitmapFactory.decodeResource(this.getResources(), R.drawable.bird120);
		printer.esc.image.drawOut(0,0, bitmap);
		printer.esc.text.drawOut(0,30,"������������\r\n");
		bitmap = BitmapFactory.decodeResource(this.getResources(), R.drawable.bird);
		printer.esc.image.printOut(0, bitmap, 0);
		bitmap = BitmapFactory.decodeResource(this.getResources(), R.drawable.gongzhang250);
		printer.esc.image.printOutFast(0, bitmap, 0, 50);
		printer.esc.feedLines(3);
	}
	
	/*
	 * �����Ű��ǰ�3Ӣ���ӡ���Ű棬��ѡ��ULT113xϵ�У�JLP351ϵ��
	 */
	private boolean printESC() {
		SimpleDateFormat   formatter;
		ESC.LINE_POINT[] lines = new ESC.LINE_POINT[1];
		lines[0] = new ESC.LINE_POINT(0, 575);
		
		if (!printer.wakeUp())
			return false;
		if(printer.getModel() == PRINTER_MODEL.VMP02_P)
		{
			printer.esc.image.printOutFast(0, this.getResources(),R.drawable.gongzhang250);				

			
			printer.esc.text.printOut(ALIGN.CENTER, ESC.FONT_HEIGHT.x24, true, ESC.TEXT_ENLARGE.HEIGHT_DOUBLE, "��������ִ������");
		}
		else
		{
			
//			printer.esc.image.printOut(0,this.getResources(),R.drawable.gongzhang,0);	
			printer.esc.image.drawOut(32, 0, 106, 106, ESC.IMAGE_ENLARGE.NORMAL,
					logo_data);
			printer.esc.text.printOut(150, 29, ESC.FONT_HEIGHT.x24, true,
					ESC.TEXT_ENLARGE.HEIGHT_WIDTH_DOUBLE, "��������ִ������");
		}
		

				
		for (int i = 0; i < 4; i++) {
			printer.esc.graphic.linedrawOut(lines);
		}
		printer.esc.feedDots(4);
		printer.esc.text.printOut(ALIGN.CENTER, ESC.FONT_HEIGHT.x24, true,
				ESC.TEXT_ENLARGE.NORMAL, "�ֳ�����¼");
		if(printer.getModel() == PRINTER_MODEL.VMP02)
		{	
			printer.esc.barcode.code128_auto_printOut(ALIGN.CENTER,
				ESC.BAR_UNIT.x2, 56, ESC.BAR_TEXT_POS.BOTTOM,
				ESC.BAR_TEXT_SIZE.ASCII_8x16, "A02161645760");
			
		}
		else
		{
			printer.esc.barcode.code128_auto_printOut(ALIGN.CENTER,
					ESC.BAR_UNIT.x3, 56, ESC.BAR_TEXT_POS.NONE,
					ESC.BAR_TEXT_SIZE.ASCII_8x16, "A02161645760");
		
		}


		printer.esc.text.printOut("������ˣ��Ϻ���ǿ���ӿƼ����޹�˾");
		printer.esc.text.printOut("��ϵ�绰��13371967607" + "   �������룺201206");
		printer.esc.text.printOut("����������(��������)������" + "   ְ���ܾ���");
		printer.esc.text.printOut("�����أ��ֶ�1��");
		formatter   =   new   SimpleDateFormat("yyyy��MM��dd��HHʱ");  
		printer.esc.text.printOut("���ʱ�䣺" + formatter.format(System.currentTimeMillis()));
		printer.esc.text.printOut("���ص㣺�ֶ����·258��2��¥2��\n");
		printer.esc.text.drawOut("�����Աʾ֤��飬����¼��\n");
		printer.esc.text.printOut("    �����ලԱ" + "����" + "��" + "����" + "��" + "�Դ�"
				+ "����ͬ��,��" + "�Ϻ���ǿ���ӿƼ����޹�˾" + "�����˼�飬����鷢�֣�");
		printer.esc.text.printOut("1.������������\n2.�ſ���С��档\n3.����δ��ʱ��ࡣ\r\n");
		
		if(printer.getModel() != PRINTER_MODEL.VMP02)
		{
			//unit        version    ecc
			//BAR_UNIT.x3, 0 ,       2    �ɴ�ӡ280������
			printer.esc.barcode.barcode2D_QRCode(0,0,BAR_UNIT.x3,0,2,"��ά����һ�����Ѽ���1" +
					"�����������Ѿ�ʮ����2" +
					"һ�������������Ѿ�03" 
					+
					"һ�������������Ѿ�04" +
					"һ�������������Ѿ�05" +
					"һ�������������Ѿ�06" +
					"һ�������������Ѿ�07" +
					"һ�������������Ѿ�08" +
					"һ�������������Ѿ�09" +
					"һ�������������Ѿ�10"+
					"һ�������������Ѿ�11" +
					"һ�������������Ѿ�12" +
					"һ�������������Ѿ�13" +
					"һ�������������Ѿ�14" +
					"һ�������������Ѿ�15" +
					"һ�������������Ѿ�16" +
					"һ�������������Ѿ�17" +
					"һ�������������Ѿ�18" +
					"һ�������������Ѿ�19" +
					
					"һ�������������Ѿ�20" +
					"һ�������������Ѿ�21" +
					"һ�������������Ѿ�22" +
					"һ�������������Ѿ�23" +
					"һ�������������Ѿ�24" +
					
					"һ�������������Ѿ�25" +
					"һ�������������Ѿ�26" +
					"һ�������������Ѿ�27" +
				
					
					"һ�������������Ѿ�ʮ");
//);
	
			printer.esc.feedEnter();
		}
	
	
	
		printer.esc.feedDots(200);
		printer.esc.text.setBold(true);	
		printer.esc.text.printOut("��������ĺ�ǩ����\n");
		printer.esc.text.drawOut(0, 16, "����    ��  ��  ��");
		printer.esc.text.drawOut(280, 32, "�����������ظ���");
		 formatter   =   new   SimpleDateFormat("yyyy��MM��dd��");
		printer.esc.text.drawOut(280, 0, formatter.format(System.currentTimeMillis()));
		printer.esc.feedEnter();
		printer.esc.text.printOut("�����ලԱǩ����\n");
		printer.esc.text.printOut("����    ��  ��  ��");
		for (int i = 0; i < 4; i++) {
			printer.esc.graphic.linedrawOut(lines);
		}
		printer.esc.feedDots(4);
		printer.esc.text.printOut(ALIGN.RIGHT, ESC.FONT_HEIGHT.x16, false,
				ESC.TEXT_ENLARGE.NORMAL, "�л����񹲺͹��������ƶ�");

		
		
      //֧����sample	
//		printer.esc.text.printOut("���κţ�200122");
//		printer.esc.barcode.CODE128_auto("200122-1");
//		printer.esc.text.printOut("�������ͣ���ʱ��");
//		printer.esc.text.printOut("����������2");
//		printer.esc.text.printOut("�����ţ�200122-1");
//		printer.esc.text.printOut("����������3");
//		
//		for (int i = 0; i < 4; i++) {
//		printer.esc.graphic.linedrawOut(lines);
//		}
//		
//		printer.esc.text.printOut("              XX");
//		printer.esc.text.printOut("           ֧������Ա��");
//		printer.esc.barcode.CODE128_auto("10000001");
//		printer.esc.text.printOut("�����ţ�10000001");
//		printer.esc.text.printOut("�������ͣ���ʱ��");
//		printer.esc.text.printOut("Ԥ���ʹ�ʱ�䣺");
//		printer.esc.text.printOut("�ͻ�������");
//		printer.esc.text.printOut("��ϵ�绰��");
//		printer.esc.text.printOut("�ջ���ַ��");
//		printer.esc.text.printOut("��Ʒ����  ����  ����  ����  ���");
//
//		for (int i = 0; i < 4; i++) {
//			printer.esc.graphic.linedrawOut(lines);
//			}
//		printer.esc.feedDots(80);
//		for (int i = 0; i < 4; i++) {
//			printer.esc.graphic.linedrawOut(lines);
//			}
//
//		printer.esc.text.printOut("                   �ϼƣ�100");
//		printer.esc.text.printOut("                   �Żݽ�20");
//		printer.esc.text.printOut("                   ������80");
//		printer.esc.text.printOut("ȱ����Ʒ��Ϣ");
//		printer.esc.text.printOut("��Ʒ����  ����  ����  ����  ���");
//		for (int i = 0; i < 4; i++) {
//			printer.esc.graphic.linedrawOut(lines);
//			}
//		printer.esc.text.printOut("�����ţ�10000001");
//		printer.esc.text.printOut("�ͻ�ǩ�֣�������");
//		printer.esc.text.printOut("           xx");
//		printer.esc.text.printOut("       ֧������Ա��");
//		
//		printer.esc.feedEnter();
	

		return true;
	}
	
	private boolean getPrinterState()
	{	
		if (!printer.getPrinterState(3000))
		{
			Toast.makeText(this, "��ȡ��ӡ��״̬ʧ��", Toast.LENGTH_SHORT).show();
			return false;
		}
		
		if (printer.isCoverOpen)
		{
			Toast.makeText(this, "��ӡ��ֽ�ָ�δ�ر�", Toast.LENGTH_SHORT).show();
			return false;
		}
		else if (printer.isNoPaper)
		{
			Toast.makeText(this, "��ӡ��ȱֽ", Toast.LENGTH_SHORT).show();			
			return false;
		}
		return true;
	}
	
	public void EnforcementPrintButton_click(View view)
	{
		if (printer == null)
		{
			Log.e("JQ", "printer null");
			return;
		}
		buttonPrint.setVisibility(Button.INVISIBLE);
		
	/*	if (!getPrinterState())
		{
			buttonPrint.setVisibility(Button.VISIBLE);;
			return ;
		}*/
		
	//	print_image_test();
		printESC();//��һ��	
	//	printer.feedRightMark();
	//	print();//�ڶ���
	//	printer.feedLeftMark();
		int i=0;
		try {Thread.sleep(5000);} catch (InterruptedException e) {}
		for (i = 0; i < 10; i++) {
			if (!printer.getPrinterState(3000)) { //��ʱʱ�����Ҳ����ɻ�ȡ״̬ʧ�ܣ��˳�ʱʱ��ʹ�ӡ�����ݶ����йء�
				//Toast.makeText(this, "��ȡ��ӡ��״̬ʧ��", Toast.LENGTH_SHORT).show();
				try {Thread.sleep(1000);} catch (InterruptedException e) {}
				continue;
			}
			if (printer.isCoverOpen) {
				Toast.makeText(this, "��ӡ��ֽ�ָ�δ�ر�", Toast.LENGTH_SHORT).show();
				return;
			} else if (printer.isNoPaper) {
				Toast.makeText(this, "��ӡ��ȱֽ", Toast.LENGTH_SHORT).show();
				return;
			}
			if (!printer.isPrinting) //��ʾ��ӡ����
			{
				Toast.makeText(this, "��ӡ����", Toast.LENGTH_SHORT).show();
				break; 
			}
			else //����ȴ�500ms,��������ȡ״̬
			{
				try {Thread.sleep(500);} catch (InterruptedException e) {}
			}
		}
		if (i == 10)
		{
			Toast.makeText(this, "��ӡ����", Toast.LENGTH_SHORT).show();
		}
		
		buttonPrint.setVisibility(Button.VISIBLE);
	}
	
	@Override
	public void finish() 
	{
		super.finish();			
	}
	
	public void EnforcementSetting_click(View view)
	{
		Intent myIntent = new Intent(ebMainActivity.this, ebSettingActivity.class);
    	startActivity(myIntent);		
	}    

}
